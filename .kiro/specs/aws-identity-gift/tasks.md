# 実装計画：AWS Identity Gift 2025

## 概要

この実装計画は、要件定義書と設計書に基づいて、AWS Identity Gift 2025アプリケーションを段階的に構築するためのタスクリストです。各タスクは前のタスクの成果物を基に構築され、最終的に完全に機能するアプリケーションが完成します。

## タスク

- [x] 1. プロジェクト基盤とデータ構造の設定
  - Next.js App Routerの基本構造を確認
  - TypeScript型定義ファイルを作成（DiagnosticMode、Question、DiagnosticResult等）
  - サービスマスタ（services.csv）の読み込みユーティリティを実装
  - _要件: 10.1、10.5_

- [ ] 2. 診断方針と設問データの作成
  - [x] 2.1 Tech-Fit用の設問データを作成
    - クイック5問と詳細15問の合計20問を定義
    - 多肢選択式と自由記述式の質問を含める
    - _要件: 3.1、3.2、3.3_
  
  - [x] 2.2 Vibe-Fit用の設問データを作成
    - クイック5問と詳細15問の合計20問を定義
    - 性格とライフスタイルに焦点を当てた質問
    - _要件: 3.1、3.2、3.3_
  
  - [ ] 2.3 Adventure用の設問データを作成
    - クイック5問と詳細15問の合計20問を定義
    - 憧れと挑戦心に焦点を当てた質問
    - _要件: 3.1、3.2、3.3_

- [ ] 3. トップページとクリスマステーマUIの実装
  - [ ] 3.1 トップページコンポーネントを作成
    - クリスマスツリー画像を中央に配置
    - 「診断を始める」ボタンを実装
    - データ取り扱いに関する免責表示を追加
    - _要件: 8.1、11.1、14.3_
  
  - [ ] 3.2 降雪エフェクトコンポーネントを実装
    - CSS/JavaScriptで降雪アニメーションを作成
    - _要件: 8.3_
  
  - [ ] 3.3 クレジット表記コンポーネントを実装
    - フッターに「いらすとや」のクレジットを表示
    - _要件: 8.6_
  
  - [ ] 3.4 Tailwind CSSでクリスマステーマのスタイリングを適用
    - 赤、緑、金のグラデーション配色
    - _要件: 8.2、8.5_

- [ ] 4. 診断フローUIの実装
  - [ ] 4.1 診断方針選択コンポーネントを実装
    - Tech-Fit、Vibe-Fit、Adventureの3つのオプションを表示
    - 選択時に対応する設問セットを読み込む
    - _要件: 1.1、1.2、1.3、1.4、1.5_
  
  - [ ] 4.2 質問ボリューム選択コンポーネントを実装
    - クイック（5問）と詳細（20問）の選択UI
    - デフォルトでクイックを選択
    - _要件: 2.1、2.2_
  
  - [ ] 4.3 質問フォームコンポーネントを実装
    - 多肢選択式と自由記述式の質問表示
    - 回答の保存と状態管理
    - ボリューム切り替え時の回答保持
    - 必須質問の検証
    - データ取り扱いに関する免責表示を追加
    - _要件: 3.1、3.2、3.3、3.4、3.5、2.3、2.4、2.5、14.1_

- [ ] 5. Amplify診断Functionの実装
  - [ ] 5.1 診断Function（Lambda）を作成
    - Bedrock APIを呼び出すハンドラーを実装
    - エラーハンドリングを追加
    - _要件: 4.1、4.2、12.1、12.4、12.5_
  
  - [ ] 5.2 Claudeプロンプトテンプレートを作成
    - 診断方針別のプロンプトを定義
    - サービスマスタリストを含める
    - JSON形式での出力を要求
    - _要件: 4.2、4.3、4.4、4.5、4.6_
  
  - [ ] 5.3 Amplify backend.tsでBedrock権限を設定
    - IAMポリシーでbedrock:InvokeModelを許可
    - _要件: 4.7_

- [ ] 6. 診断結果表示とアニメーションの実装
  - [ ] 6.1 ギフト開封アニメーションコンポーネントを実装
    - 揺れるアニメーション
    - 開封アニメーション（光のエフェクト）
    - _要件: 5.1、5.2、5.3_
  
  - [ ] 6.2 診断結果表示コンポーネントを実装
    - サービス名、キャッチコピー、AIレター、ネクストアクション、タイムスタンプを表示
    - AI生成コンテンツに関する免責表示を追加
    - _要件: 5.4、5.5、14.2_

- [ ] 7. LocalStorage結果アーカイブの実装
  - [ ] 7.1 LocalStorage管理ユーティリティを実装
    - 結果の保存、読み取り、削除機能
    - 最大9件の制限と古い結果の自動削除
    - タイムスタンプの付与
    - エラーハンドリング
    - _要件: 6.1、6.2、6.3、6.4、6.5、6.6、12.2_
  
  - [ ] 7.2 ギフトアーカイブ表示コンポーネントを実装
    - LocalStorageから結果を読み込み
    - 3種類のギフト画像を循環使用
    - 事前定義された座標でギフトを配置
    - ギフトクリック時に結果を表示
    - ホバーとクリックアニメーション
    - _要件: 7.1、7.2、7.3、7.4、7.5、8.4_

- [ ] 8. ギフトカード画像生成機能の実装
  - [ ] 8.1 ギフトカード生成Function（Lambda）を作成
    - Claude 4.5でビジュアル画像を生成
    - Canvasで文字情報を重ね合わせ
    - Base64エンコードで返却
    - サーバー側で画像を保存しない
    - _要件: 9.2、9.3、9.4、9.5、9.8_
  
  - [ ] 8.2 ギフトカード生成コンポーネントを実装
    - 診断結果表示時に自動的に画像生成を開始
    - 生成中のローディング表示
    - 生成完了後に画像を表示
    - プレミア感を演出するメッセージとSNSシェアボタン
    - _要件: 9.1、9.6、9.7、13.2_
  
  - [ ] 8.3 SNSシェア機能を実装
    - 生成済みギフトカード画像をOGP画像として使用
    - Twitter、Facebook等のシェアボタン
    - _要件: 9.9_
  
  - [ ] 8.4 Amplify backend.tsでギフトカードFunction用のBedrock権限を設定
    - IAMポリシーでbedrock:InvokeModelを許可
    - _要件: 9.2_

- [ ] 9. エラーハンドリングとユーザーフィードバックの実装
  - [ ] 9.1 フロントエンドエラーハンドリングを実装
    - Bedrock API呼び出しエラー
    - LocalStorageエラー
    - ネットワークエラー
    - 日本語エラーメッセージ
    - _要件: 12.1、12.2、12.3、12.5_
  
  - [ ] 9.2 バックエンドエラーハンドリングを実装
    - ThrottlingException処理
    - ValidationException処理
    - 一般的なエラー処理
    - コンソールログ出力
    - _要件: 12.4、12.5_

- [ ] 10. 統合とテスト
  - [ ]* 10.1 診断フロー全体の統合テスト
    - 方針選択→質問回答→結果表示→保存の流れを確認
    - _要件: 1.1-5.5_
  
  - [ ]* 10.2 アーカイブ機能の統合テスト
    - 複数回の診断実行と結果保存
    - 9件制限の動作確認
    - ギフトクリックと結果表示
    - _要件: 6.1-7.5_
  
  - [ ]* 10.3 ギフトカード生成の統合テスト
    - 自動生成の動作確認
    - SNSシェアの動作確認
    - _要件: 9.1-9.9_

- [ ] 11. 最終チェックポイント
  - すべてのテストが成功することを確認
  - ユーザーに質問があれば確認

## 注意事項

- 各タスクは前のタスクの完了を前提としています
- テストは実装と並行して実行し、問題があれば即座に修正します
- ユーザーフィードバックを各チェックポイントで収集します
