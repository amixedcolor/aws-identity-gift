# 要件定義書：AWS Identity Gift 2025

## はじめに

「Your AWS Identity 2025 〜あなたに贈る「代名詞」〜」は、ユーザーの技術的アイデンティティを表すAWSサービスを診断・推薦するWebアプリケーションです。本システムは、AI分析を用いて、ユーザーのスキル、性格、または憧れに基づいて100種類以上のAWSサービスの中から最適なものをマッチングし、クリスマスをテーマにした演出で結果を提供します。

## 用語集

- **システム**: AWS Identity GiftのWebアプリケーション
- **ユーザー**: 診断ツールを使用するAWSエンジニアまたは開発者
- **診断エンジン**: ユーザーの回答を分析し、AWSサービスを推薦するAI搭載コンポーネント
- **サービスマスタ**: 23カテゴリにわたる100種類以上のAWSサービスの厳選リスト
- **診断方針**: 3つの分析アプローチのいずれか（Tech-Fit、Vibe-Fit、Adventure）
- **設問セット**: 特定の診断方針に合わせた質問の集合
- **診断結果**: 推薦サービス、キャッチコピー、AIレター、ネクストアクションを含む出力
- **結果アーカイブ**: LocalStorageに保存された過去の診断結果のコレクション
- **ギフト表示**: クリスマスツリーの周りにギフトボックスとして表示されるアーカイブ結果の視覚表現
- **OGP画像**: ソーシャルメディア共有用のOpen Graph Protocol画像
- **Claudeモデル**: Amazon BedrockのClaude Sonnet 4.5 AIモデル（jp.anthropic.claude-sonnet-4-5-20250929-v1:0）

## 要件

### 要件1：診断方針の選択

**ユーザーストーリー:** ユーザーとして、システムが自分をどのように分析するかを選択したい。そうすることで、自分の好みに合った推薦を得られる。

#### 受入基準

1. WHEN ユーザーが診断インターフェースにアクセスする、THE システム SHALL 3つの診断方針オプションを表示する
2. THE システム SHALL スキルと経験に基づく分析のためのTech-Fitモードを提供する
3. THE システム SHALL 性格とライフスタイルに基づく分析のためのVibe-Fitモードを提供する
4. THE システム SHALL 憧れと意外性に基づく分析のためのAdventureモードを提供する
5. WHEN ユーザーが診断方針を選択する、THE システム SHALL 対応する設問セットを読み込む

### 要件2：質問ボリュームの選択

**ユーザーストーリー:** ユーザーとして、診断にかける時間を制御したい。そうすることで、深さと利便性のバランスを取れる。

#### 受入基準

1. THE システム SHALL 2つの質問ボリュームを提供する：クイック（5問、1分）と詳細（20問、5分）
2. THE システム SHALL デフォルトでクイックモードにする
3. WHEN ユーザーがクイックモードの質問を完了する、THE システム SHALL 送信または詳細モードへの継続のオプションを提供する
4. WHEN ユーザーが詳細モードにいる、THE システム SHALL クイックモードの回答のみで送信することを許可する
5. THE システム SHALL ボリューム切り替え時に回答済みの質問をすべて保持する

### 要件3：質問の提示と回答の収集

**ユーザーストーリー:** ユーザーとして、自分のスキルと好みについての質問に答えたい。そうすることで、システムが適切なAWSサービスを推薦できる。

#### 受入基準

1. WHEN 質問を表示する、THE システム SHALL 選択された診断方針に固有の質問を提示する
2. THE システム SHALL 事前定義された選択肢を持つ多肢選択式の質問をサポートする
3. THE システム SHALL 自由記述式の質問をサポートする
4. THE システム SHALL 送信を許可する前にすべての必須質問が回答されていることを検証する
5. THE システム SHALL 診断エンジンによる分析のためにユーザーの回答を保存する

### 要件4：AI駆動のサービス推薦

**ユーザーストーリー:** ユーザーとして、システムに自分の回答を分析してAWSサービスを推薦してほしい。そうすることで、自分の技術的アイデンティティを表すサービスを発見できる。

#### 受入基準

1. WHEN ユーザーが回答を送信する、THE システム SHALL Amazon Bedrock経由でClaudeモデルを呼び出す
2. THE システム SHALL Claudeモデルに選択された診断方針、ユーザーの回答、サービスマスタリストを提供する
3. THE システム SHALL Claudeモデルにサービスマスタから正確に1つのAWSサービスを選択するよう要求する
4. THE システム SHALL Claudeモデルにパーソナライズされたキャッチコピーを生成するよう要求する
5. THE システム SHALL Claudeモデルに推薦理由を説明するAIレターを生成するよう要求する
6. THE システム SHALL Claudeモデルにサービス習得のための具体的なネクストアクションを生成するよう要求する
7. THE システム SHALL リージョン「ap-northeast-1」でモデルID「jp.anthropic.claude-sonnet-4-5-20250929-v1:0」を使用する

### 要件5：アニメーション付き結果表示

**ユーザーストーリー:** ユーザーとして、診断結果が魅力的な方法で明らかにされるのを見たい。そうすることで、体験が特別で記憶に残るものになる。

#### 受入基準

1. WHEN 診断エンジンが分析を完了する、THE システム SHALL ギフトボックスのアニメーションを表示する
2. THE システム SHALL ギフトボックスを揺れる動きでアニメーションする
3. THE システム SHALL ギフトボックスを光のエフェクトとともに開くアニメーションをする
4. WHEN アニメーションが完了する、THE システム SHALL 診断結果を表示する
5. THE システム SHALL AWSサービス名、キャッチコピー、AIレター、ネクストアクション、タイムスタンプを表示する

### 要件6：LocalStorageでの結果アーカイブ

**ユーザーストーリー:** ユーザーとして、診断結果をローカルに保存してほしい。そうすることで、アカウントを必要とせずに過去の結果を確認できる。

#### 受入基準

1. WHEN 診断結果が生成される、THE システム SHALL それをブラウザのLocalStorageに保存する
2. THE システム SHALL 複数の診断セッションをサポートするために結果を配列として保存する
3. THE システム SHALL キャッシュがクリアされるまでブラウザセッションを跨いで結果を永続化する
4. THE システム SHALL 最大9件のアーカイブ結果を維持する
5. WHEN 10件目の結果が追加される、THE システム SHALL 新しい結果を追加する前に最も古い結果を削除する
6. THE システム SHALL 各アーカイブ結果にタイムスタンプを含める

### 要件7：視覚的な結果アーカイブ表示

**ユーザーストーリー:** ユーザーとして、過去の診断結果がクリスマスツリーの周りにギフトとして表示されるのを見たい。そうすることで、診断履歴を視覚化できる。

#### 受入基準

1. WHEN システムが読み込まれる、THE システム SHALL LocalStorageからアーカイブ結果を取得する
2. THE システム SHALL 各アーカイブ結果をクリスマスツリーの周りにギフトボックス画像として表示する
3. THE システム SHALL 3つのギフト画像を順番に使用する：christmas_gift1_present.png、christmas_gift2_candy.png、christmas_gift3_socks.png
4. THE システム SHALL 視覚的なランダム性を持つ事前定義された座標を使用してギフトを配置する
5. WHEN ユーザーがギフトをクリックする、THE システム SHALL 対応する診断結果を表示する

### 要件8：クリスマステーマのUIデザイン

**ユーザーストーリー:** ユーザーとして、お祭り気分で視覚的に魅力的なインターフェースが欲しい。そうすることで、診断体験が特別で季節感のあるものになる。

#### 受入基準

1. THE システム SHALL クリスマスツリー画像（christmas_tree.png）を中心的な視覚要素として表示する
2. THE システム SHALL クリスマスの赤、緑、金をグラデーションで基調とした配色を使用する
3. THE システム SHALL 降雪アニメーションエフェクトを実装する
4. THE システム SHALL ギフトボックスのホバーとクリックアニメーションを実装する
5. THE システム SHALL アニメーション用のカスタムCSSとともにTailwind CSSをスタイリングに使用する
6. THE システム SHALL 画像のクレジット表記として「いらすとや」を表示する

### 要件9：パーソナライズされたギフトカード画像の生成と共有

**ユーザーストーリー:** ユーザーとして、診断結果と一緒に自分だけのギフトカード画像を受け取りたい。そうすることで、特別感を感じ、ソーシャルメディアで共有したくなる。

#### 受入基準

1. WHEN 診断結果が表示される、THE システム SHALL 自動的にギフトカード画像の生成を開始する
2. THE システム SHALL 画像生成中に「あなただけのギフトカードを生成しています」というメッセージを表示する
3. THE システム SHALL Claudeモデルを使用して選ばれたAWSサービスに相応しいビジュアル画像を生成する
4. THE システム SHALL 生成された画像に一切の文字情報を含めない
5. THE システム SHALL AWSサービス名、キャッチコピー、ユーザー名（オプション）をHTML/CSSで画像に重ね合わせる
6. WHEN 画像生成が完了する、THE システム SHALL ギフトカード画像を結果画面に表示する
7. THE システム SHALL 「この画像は保存されておらず、今ここにしかないあなただけのものです。みんなに見せびらかしませんか？」というメッセージとともにSNSシェアボタンを表示する
8. THE システム SHALL サーバー側で画像を一切保存しない
9. WHEN ユーザーがSNSシェアボタンをクリックする、THE システム SHALL 生成済みのギフトカード画像をOGP画像として使用する
10. THE システム SHALL 過剰なLambda呼び出しを防ぐために適切なキャッシュヘッダーを設定する

### 要件10：サービスマスタデータの管理

**ユーザーストーリー:** システム管理者として、包括的なAWSサービスのリストが欲しい。そうすることで、診断エンジンが多様な選択肢から推薦できる。

#### 受入基準

1. THE システム SHALL `app/public/services.csv`に配置された100種類以上のAWSサービスを含むサービスマスタを使用する
2. THE システム SHALL サービスを23のAWSカテゴリに整理する
3. THE システム SHALL 人気のあるサービスとニッチなサービスの両方を含める
4. THE システム SHALL 公式AWSドキュメントからサービスカテゴリを取得する
5. THE システム SHALL サービスマスタを診断エンジンで利用可能にする

### 要件11：認証不要

**ユーザーストーリー:** ユーザーとして、アカウントを作成せずにすぐに診断ツールを使用したい。そうすることで、素早く結果を得られる。

#### 受入基準

1. THE システム SHALL 認証なしですべての診断機能へのアクセスを許可する
2. THE システム SHALL 個人を特定できる情報を収集または保存しない
3. THE システム SHALL ユーザー登録またはログインを要求しない
4. THE システム SHALL クライアント側ストレージ（LocalStorage）のみで完全に機能する

### 要件12：エラーハンドリングとユーザーフィードバック

**ユーザーストーリー:** ユーザーとして、エラーが発生したときに明確なフィードバックが欲しい。そうすることで、何が問題で、どう進めばよいかを理解できる。

#### 受入基準

1. WHEN Claudeモデルの呼び出しが失敗する、THE システム SHALL ユーザーにエラーメッセージを表示する
2. WHEN LocalStorageが満杯または利用不可である、THE システム SHALL ユーザーに通知する
3. WHEN ネットワーク接続が失われる、THE システム SHALL ユーザーに通知し、再試行を提案する
4. THE システム SHALL デバッグ目的でエラーをコンソールにログ出力する
5. THE システム SHALL 日本語でユーザーフレンドリーなエラーメッセージを提供する

### 要件13：パフォーマンスとレスポンシブ性

**ユーザーストーリー:** ユーザーとして、アプリケーションが素早く読み込まれ、スムーズに応答してほしい。そうすることで、快適な体験ができる。

#### 受入基準

1. THE システム SHALL 標準的なブロードバンド接続で3秒以内に初期ページを読み込む
2. THE システム SHALL AI分析中にローディングインジケーターを表示する
3. THE システム SHALL 通常の条件下で10秒以内に診断分析を完了する
4. THE システム SHALL モダンブラウザで60フレーム/秒でアニメーションをレンダリングする
5. THE システム SHALL デスクトップとモバイルデバイスでレスポンシブかつ機能的である

### 要件14：データ取り扱いとAI生成コンテンツの免責表示

**ユーザーストーリー:** ユーザーとして、自分のデータがどのように扱われるか、AI生成コンテンツの性質を理解したい。そうすることで、安心してサービスを利用できる。

#### 受入基準

1. THE システム SHALL 質問回答画面に「入力されたデータはAI分析にのみ使用され、一切保存されません」という表示を含める
2. THE システム SHALL 診断結果画面に「この結果はAIで生成されたものであり、その信憑性についてはご自身でお確かめください」という表示を含める
3. THE システム SHALL トップページに「本サービスはユーザー識別情報を収集せず、すべてのデータはブラウザのLocalStorageにのみ保存されます」という表示を含める
4. THE システム SHALL すべての免責表示を日本語で提供する
5. THE システム SHALL 免責表示を視認しやすい位置に配置する
